# Управление потоком

## Defer

Мы можем использовать ключевое слово defer для отложенного выполнения кода до выхода из текущей зоны видимости, независимо от того, каким способом она завершается (например, при возврате функции, выходе из блока кода или при выбросе ошибки).
Defer позволяет нам гарантировать выполнение определенного кода перед тем, как текущая область видимости будет завершена.
Мы можем вызывать defer внутри функций, методов, замыканий или любых других областей видимости.

```
func processFile() {
    print("Opening file")
    
    defer {
        print("Closing file")
    }

    print("Processing file")
}
//Opening file
//Processing file
//Closing file
```

Если мы напишем больше чем один defer в блоке одной зоны видимости, то первый выполнится тот который находится ближе к выходу из зоны видимости:

```
if score < 10 {
    defer {
        print(score)
    }
    defer {
        print("The score is:")
    }
    score += 5
}
// Prints "The score is:"
// Prints "6"
```

Если наша программа остановится во время выполнения - например при возникновении runtime error или crash, то defer не будет выполнен. Однако defer выполнится после выброса ошибки(throw).
